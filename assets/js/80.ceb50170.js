(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{406:function(e,a,i){"use strict";i.r(a);var t=i(4),s=Object(t.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h3",{attrs:{id:"h5页面和小程序交互"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#h5页面和小程序交互"}},[e._v("#")]),e._v(" h5页面和小程序交互")]),e._v(" "),a("blockquote",[a("p",[e._v("小程序web-view 组件是一个可以用来承载网页的容器，会自动铺满整个小程序页面。"),a("strong",[e._v("个人类型与海外类型的小程序暂不支持使用")]),e._v("。")])]),e._v(" "),a("h4",{attrs:{id:"引入jsdk文挡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#引入jsdk文挡"}},[e._v("#")]),e._v(" 引入jsdk文挡")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v('<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"><\/script>\n')])])]),e._v(" "),a("h4",{attrs:{id:"h5跳转小程序页面-demo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#h5跳转小程序页面-demo"}},[e._v("#")]),e._v(" h5跳转小程序页面  demo")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("$('.span-icon1').click(function(){\n    wx.miniProgram.navigateTo({url:'/pages/share/share'});\n})\n")])])]),a("h4",{attrs:{id:"h5嵌入小程序传递message给小程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#h5嵌入小程序传递message给小程序"}},[e._v("#")]),e._v(" h5嵌入小程序传递message给小程序")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("wx.miniProgram.postMessage(Util.shareToWechart(params));   // 传递消息给webview\n\nweb-view 通过属性 bindmessage 触发得到h5传过来的消息。\n")])])]),a("h5",{attrs:{id:"相关的api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关的api"}},[e._v("#")]),e._v(" 相关的api")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("wx.miniProgram.navigateTo     //跳转小程序页面\nwx.miniProgram.navigateBack   //返回小程序上一个路由\nwx.miniProgram.switchTab    //切换tab\nwx.miniProgram.reLaunch    //重新启动\nwx.miniProgram.redirectTo   // 跳转小程序，删除当前页面，类似 history.replace()\nwx.miniProgram.postMessage  //向小程序传递信息\nwx.miniProgram.getEnv    //获取当前环境\n\n//获取小程序环境\nwx.miniProgram.getEnv(function(res) {\n    console.log(res.miniprogram) // true \n})\n")])])]),a("p",[e._v("其他api  包括图像接口、音频接口、设备信息、地理位置等，自行查看https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html")]),e._v(" "),a("h4",{attrs:{id:"tip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tip"}},[e._v("#")]),e._v(" tip")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("网页内 iframe 的域名也需要配置到域名白名单。\n开发者工具上，可以在 <web-view> 组件上通过右键 - 调试，打开 <web-view> 组件的调试。\n每个页面只能有一个 <web-view>，<web-view> 会自动铺满整个页面，并覆盖其他组件。\n<web-view> 网页与小程序之间不支持除 JSSDK 提供的接口之外的通信。\n在 iOS 中，若存在JSSDK接口调用无响应的情况，可在 <web-view> 的 src 后面加个#wechat_redirect解决。\n避免在链接中带有中文字符，在 iOS 中会有打开白屏的问题，建议加一下 encodeURIComponent\n")])])]),a("p",[e._v("这些东西实际上在小程序开发文档都可以查看到，我主要记录一下我在开发web-view的时候，所遇到的一些问题")]),e._v(" "),a("h4",{attrs:{id:"屏幕适配-除了屏幕适配外-其他的东西jssdk有提供就用-没有提供就没有办法罗。。。。o-o"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#屏幕适配-除了屏幕适配外-其他的东西jssdk有提供就用-没有提供就没有办法罗。。。。o-o"}},[e._v("#")]),e._v(" 屏幕适配 （除了屏幕适配外，其他的东西jssdk有提供就用，没有提供就没有办法罗。。。。o("),a("em",[e._v("￣︶￣")]),e._v(")o）")]),e._v(" "),a("h5",{attrs:{id:"iphonex"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#iphonex"}},[e._v("#")]),e._v(" iPhoneX")]),e._v(" "),a("p",[e._v("ipx再浏览器手机模拟器中，我们可以看到设备的宽高分别为375、812、dpr=3，我们的设计稿是ip6的设计稿，对于ipx需要做单独的样式。")]),e._v(" "),a("p",[e._v("按照我们的思路，可以获取设备信息，动态增减类，来控制样式；也可以写媒体查询，根据屏幕的宽或则高，或则dpr来做控制。")]),e._v(" "),a("p",[e._v("首先，我们项目中不知道谁写了一个判断ipx的的方法。。。。如下")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("isIphoneX: function () {\n    return /iphone/gi.test(navigator.userAgent) && (screen.height == 812 && screen.width == 375)\n},\n")])])]),a("p",[e._v("同事，告诉我，他们就是用的这个方法，我也就没有在意，粗略一看，没什么问题，是判断ipx的方法，于是乎。。。。。经过我在小程序测试，发现这个")]),e._v(" "),a("p",[e._v("方法，并没有起到作用，原因是web-view组件中嵌入h5页面，你在h5页面中获取的屏幕高度并不是ipx通屏的高度。。。。还记得小程序头顶上的一些东西吗？")]),e._v(" "),a("p",[e._v("经过测试，在小程序web-view中，ipx的height只有724px。。。")]),e._v(" "),a("p",[e._v("发现问题了，立马弃用公共的判断方法，当然，也可以重新判断高度的。我们决定采用媒体查询来做，代码如下：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("//ipx 适配\n@media only screen and (device-width: 375px) and (device-height:724px) and (-webkit-device-pixel-ratio:3),\nonly screen and (device-width: 375px) and (device-height:812px) and (-webkit-device-pixel-ratio:3) {\n    .christmas_activity {\n        background: url('../images/home-bg-ipx.jpg') no-repeat;\n        background-size: 100% 100%;\n\n        .foot {\n            height: 2.5rem;\n            bottom: 0;\n        }\n    }\n\n\n}\n\n这里媒体查询写死了两种屏幕的宽高，一种是ipx通屏，一种是ipx在小程序中的，这样就可以做到ipx的适配。嗯，不错。\n")])])]),a("p",[e._v("但是，只是做到了ipx的适配，如果尺寸不是ipx的尺寸，但是屏幕比ipx还长，或则比它短一点呢？又是另外的问题了，目前，我采用的方法是ip6用一张背景图，比ip6-plus高度还大的手机换ipx的背景图，这样基本可以做到长屏幕手机上面背景图片不会拉伸了，哈哈哈。")]),e._v(" "),a("blockquote",[a("p",[e._v("其实web-view组件嵌套h5页面还是非常有必要的，就拿我们目前的小程序项目来说的话，主包除外，已经分包两个了，如果不用h5嵌套，过不了多久小程序直接就超额了，还搞个毛线。包的大小都是做了限制的，没办法罗。。。")])])])}),[],!1,null,null,null);a.default=s.exports}}]);